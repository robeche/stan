\chapter{Diagramas de Secuencia}
%================================================

\section{Procesamiento de Documento}

\begin{figure}[h]
\centering
\begin{tikzpicture}[
    node distance=1cm,
    actor/.style={rectangle, draw, fill=blue!20, minimum width=3cm, minimum height=1cm},
    message/.style={-Stealth, thick}
]

% Actores
\node[actor] (admin) at (0,0) {Admin};
\node[actor] (django) at (4,0) {Django};
\node[actor] (celery) at (8,0) {Celery};
\node[actor] (modules) at (12,0) {Módulos RAG};

% Líneas de vida
\draw[dashed] (admin) -- ++(0,-12);
\draw[dashed] (django) -- ++(0,-12);
\draw[dashed] (celery) -- ++(0,-12);
\draw[dashed] (modules) -- ++(0,-12);

% Mensajes
\draw[message] (0,-1) -- node[above] {Upload} (4,-1);
\draw[message] (4,-2) -- node[above] {Create Task} (8,-2);
\draw[message] (8,-3) -- node[above] {Parse} (12,-3);
\draw[message] (12,-4) -- node[above] {Result} (8,-4);
\draw[message] (8,-5) -- node[above] {Chunk} (12,-5);
\draw[message] (12,-6) -- node[above] {Result} (8,-6);
\draw[message] (8,-7) -- node[above] {Embed} (12,-7);
\draw[message] (12,-8) -- node[above] {Result} (8,-8);
\draw[message] (8,-9) -- node[above] {Index} (12,-9);
\draw[message] (12,-10) -- node[above] {Result} (8,-10);
\draw[message] (8,-11) -- node[above] {Complete} (4,-11);

\end{tikzpicture}
\caption{Diagrama de secuencia: Procesamiento de documento}
\end{figure}

\section{Consulta en Chatbot}

\begin{figure}[h]
\centering
\begin{tikzpicture}[
    node distance=1cm,
    actor/.style={rectangle, draw, fill=green!20, minimum width=3cm, minimum height=1cm},
    message/.style={-Stealth, thick}
]

% Actores
\node[actor] (user) at (0,0) {Usuario};
\node[actor] (chatbot) at (4,0) {Chatbot};
\node[actor] (chroma) at (8,0) {ChromaDB};
\node[actor] (ollama) at (12,0) {Ollama};

% Líneas de vida
\draw[dashed] (user) -- ++(0,-10);
\draw[dashed] (chatbot) -- ++(0,-10);
\draw[dashed] (chroma) -- ++(0,-10);
\draw[dashed] (ollama) -- ++(0,-10);

% Mensajes
\draw[message] (0,-1) -- node[above] {Query} (4,-1);
\draw[message] (4,-2) -- node[above] {Generate Embedding} (4,-2.5);
\draw[message] (4,-3) -- node[above] {Search} (8,-3);
\draw[message] (8,-4) -- node[above] {Chunks} (4,-4);
\draw[message] (4,-5) -- node[above] {Build Context} (4,-5.5);
\draw[message] (4,-6) -- node[above] {Generate} (12,-6);
\draw[message] (12,-7) -- node[above] {Response} (4,-7);
\draw[message] (4,-8) -- node[above] {Post-process} (4,-8.5);
\draw[message] (4,-9) -- node[above] {Response + Media} (0,-9);

\end{tikzpicture}
\caption{Diagrama de secuencia: Consulta en chatbot}
\end{figure}

%================================================
